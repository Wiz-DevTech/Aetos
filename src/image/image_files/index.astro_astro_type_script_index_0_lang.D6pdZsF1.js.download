import{A as g,a as l}from"./animationInstructions.oO_8Hv7Q.js";import"./index.Brfk6Bdo.js";import"./ScrollTrigger.6qCihK2t.js";class u{element;constructor(t){this.element=t,this.setupAnimation()}setupAnimation(){const t=this.element?.dataset?.animationShortcode?.split(" "),e=this.element?.dataset?.animationInstructionId?.split(" ");!t&&!e||(t&&t.length>0&&t.forEach(i=>{const n=i.split(".").reduce((a,o)=>a[o],g);l(this.element,n)}),e&&e.length>0&&e.forEach(i=>{l(this.element,window.uniqueModuleAnimations[i])}))}}class w{container;content;triggerId;innerContent;closeButton;callerTriggerId;title;constructor(t){this.container=t,this.content=t.querySelector(".content-drawer__content"),this.triggerId=t.id,this.innerContent=t.querySelector(".content-drawer__content"),this.closeButton=t.querySelector(".content-drawer__close"),this.callerTriggerId=null,this.addEventListeners(),this.setAnimationDuration(),this.title=t.dataset.dropContentName}addEventListeners(){this.content.addEventListener("click",()=>setTimeout(this.setAnimationDuration.bind(this),1e3)),window.addEventListener("contentDrawerToggle",this.handleToggle.bind(this)),window.addEventListener("resize",this.handleResize.bind(this)),this.closeButton.addEventListener("click",this.toggle.bind(this))}handleToggle(t){t.detail.triggerId===this.triggerId&&(this.toggle(),this.callerTriggerId=t.detail.containerTriggerId)}setAnimationDuration(){this.container.style.setProperty("--content-drawer-anim-duration",`${this.height()/(window.innerHeight/2)*.2+.1}s`)}handleResize(){this.setAnimationDuration()}height(){const t=parseInt(window.getComputedStyle(this.container).paddingBottom)+parseInt(window.getComputedStyle(this.container).paddingTop);return this.innerContent.scrollHeight+t}scrollIntoView(t){const e=t.getBoundingClientRect().top,i=window.scrollY,n=parseInt(document.body.style.getPropertyValue("--header-height"));window.scrollTo({top:i+e-n,left:0,behavior:"smooth"})}sendAnalytics(){this.title&&this.title.length>0&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"drawer",action:this.isOpen?"open":"close",title:this.title}))}open(){this.container.classList.add("content-drawer--open"),this.scrollIntoView(this.container),window.dispatchEvent(new CustomEvent("contentDrawerOpen",{detail:{triggerId:this.triggerId}}))}close(){if(this.container.classList.remove("content-drawer--open"),this.callerTriggerId){const t=document.querySelector(`#${this.callerTriggerId}`)?.closest("skydio-module");t&&this.scrollIntoView(t)}window.dispatchEvent(new CustomEvent("contentDrawerClose",{detail:{triggerId:this.triggerId}}))}get isOpen(){return this.container.classList.contains("content-drawer--open")}toggle(){this.isOpen?this.close():this.open(),this.sendAnalytics()}}class m{constructor(t,e){e=e/100,new IntersectionObserver((n,a)=>{n.forEach(o=>{if(o.target===t&&o.intersectionRatio>=e){const h=t.querySelectorAll("video");let s=null;if(h.forEach(c=>{const d=window.getComputedStyle(c);d.display!=="none"&&d.visibility!=="hidden"&&d.opacity!=="0"&&(s=c)}),!s)return;s.muted=!0,s.parentElement?.player?.play(),a.disconnect()}})},{threshold:[e]}).observe(t)}}class p extends HTMLElement{animation;contentDrawer;constructor(){super(),this.animation=new u(this),document.addEventListener("DOMContentLoaded",()=>{this.getAttribute("videoPlayPercentage")&&this.querySelector("[data-bg-video]")&&this.querySelectorAll("[data-bg-video] video").forEach(t=>{new m(this,parseInt(this.getAttribute("videoPlayPercentage")))})}),this.classList.contains("content-drawer")&&(this.contentDrawer=new w(this))}}customElements.define("skydio-module",p);
